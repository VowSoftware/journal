# Friday, October 5, 2024

## My first experience contributing to the Defold game engine

I've been using Defold as my game engine of choice since 2019. I've created all kinds of projects with it, but I've never searched through the engine's source code to any meaningful extent. It's a relatively large project that combines several components and several programming languages, making it quite intimidating to look at with fresh eyes. To be fair though, this is true for getting up to speed with any large software project.

I decided a several days ago that I wanted to try contributing by implementing a relatively innocent-looking feature from one of the 1,000+ issues on GitHub. After scrolling through most of them, I pinpointed one that looked reasonable enough: [adding a function to get the type of a GUI node at runtime](https://github.com/defold/defold/issues/9358).

One of the hurdles I ran into was figuring out how to contribute to a strictly managed open-source project. I've created several libraries in the past, however it's lot easier to start something and be the sole developer than join an existing project with many other developers. Throughout the whole process, I've been getting most of my answers from my good friend ChatGPT, and the ocassional piece of advice from real people. I'm not a fan of how long it takes to see even such a small feature make its way to production, but it's that way for a good reason.

The first real step was building the engine. This went okay for the most part. Part of the build process on Windows was broken due to a recent update, so I had to work through that with someone from the Defold team. Once it was fixed, the rest of the build was quick and easy to understand. Luckily I have a decent enough background in build systems, turning what's usually a major burden into a mostly manageable task. Let's be honest though, building large software with many dependencies can almost never be described as "easy".

The next step was searching the codebase in a somewhat frantic attempt to gain a tiny bit of understanding of how the project is organized, what kind of code styling is expected, and most importantly, where the relevant code is located for the feature I wanted to add. I have very little experience working with large projects, as most of the work I've done has been either building tools and libraries from scratch, or working with a few other people on relatively small software. Learning to search through code and pinpoint what might be relevant is a skill in and of itself. It's not obvious that such a skill exists to people who've never needed to aquire it. I think this process of searching and connecting dots will be a forever problem, getting slightly less time consuming the more I do it.

After gaining a general idea of what needed to be done, I was able to use surrounding code as a sort of template. I tried my best to fully understand what the surrounding functions were doing, reading them line by line until I felt confident that I wouldn't screw something up by writing my own. One challenging part of implementing a user-facing feature is using Lua's C API, something I have no experience with. It's a fundamental aspect of the language, but I'd wager that most Lua developers don't need to know about it, since they're just writing high-level scripts. It was a bit esoteric at first, but I learned rather quickly with the help of ChatGPT and my copy of Roberto Lerusalimschy's *Programming in Lua: Fourth Edition*, which has a section entirely dedicated to the C API. I've just started reading through it, but even just my introductory knowledge was enough to do what I needed to do. It's frankly a very simple API to understand.

The project uses TDD, a common practice that I've somehow never had to use until now. I'm well aware of what it entails and why it's important for projects like this. Writing a test for my code wasn't difficult. I missed a few cases that I should certainly include due to not knowing how to effectively interface with Defold's C++ API. That's something I'm still learning. Passing the tests felt great, as it was proof that I'm capable of implementing a useful feature without much hassle. In addition to build systems, my strong background in C and C++ comes in handy.

I'm now in the process of getting feedback on my draft PR. There's a somewhat lengthy checklist of requirements to meet before a PR can be accepted and merged. Since this is my first time contributing, I obviously have some questions that need answered. I want to learn this process fully, such that I'm able to continue contributing in the future without any of the introductory hurdles I experienced this time around. I'm also very grateful to have gone through this exercise, as it's a whole new way of working for me. Very applicable for future tasks and an all-around valuable skillset to have.

I did notice two things that bothered me about the source code:

* Defold auto-generates much of its documentation based on comments that are scattered around the code. It seems like the quality and style of these comments varies greatly depending on the person who wrote them. This makes it hard for me to know what kind of standard I should be conforming to.
* Reading through some of the test cases was a bit concerning. Many of them don't test what I would consider to be important corner cases, and some outright fail to test certain aspects of features. Again, this makes it hard for me to know what kind of standard I should be comforming to.

That's all there is to say about my first experience contributing to Defold's source. It was a valuable experience, and I didn't run into too much trouble getting my feet wet. I'll definitely be contributing more in the future. It gives me a good excuse to continue gaining experience working on a large open-source C++ project and strengthening all of the skills that go along with it.